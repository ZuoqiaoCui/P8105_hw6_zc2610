---
title: "p8105_hw6_zc2610"
author: "Zuoqiao Cui"
date: "2022-11-22"
output: github_document
---

```{r}
library(tidyverse)
library(modelr)
library(viridis)
library(mgcv)
```

# Problem 2

```{r}
homicide_data_df = read_csv("./data/homicide-data.csv") %>% 
janitor::clean_names()
```

Create a new variable "city_state" to combine city and state columns

```{r}
homicide_data_df = homicide_data_df %>% 
  mutate(
    city_state = str_c(city, state, sep = ",")
  ) %>% 
  select(-city,-state)
```

1. Create a new binary variable indicating whether the homicide is solved (0 means "unsolved" and 1 means "solved")

2. Omit cities Dallas, TX; Phoenix, AZ; Kansas City, MO and Tulsa, AL

3. Limit the analysis those for whom victim_race is white or black

4. Be sure victim_age is numeric

```{r}
homicide_data_df = homicide_data_df %>% 
  mutate(
    whether_solved = case_when(
      disposition == "Closed without arrest" ~ 0,
      disposition == "Open/No arrest" ~ 0,
      disposition == "Closed by arrest" ~ 1
    )
  ) %>% 
filter(
    city_state != "Dallas,TX" & city_state != "Phoenix,AZ" & city_state != "Kansas City,MO" & city_state != "Tulsa,AL"
  ) %>% 
    filter(victim_age != 'Unknown') %>% 
  mutate(victim_age = as.numeric(victim_age)) %>% 
  filter(victim_race == "White" | victim_race == "Black")
```

For the city of Baltimore, MD, use the glm function to fit a logistic regression with resolved vs unresolved as the outcome and victim age, sex and race as predictors

```{r}
homicide_Baltimore_df = homicide_data_df %>% 
  filter(city_state == 'Baltimore,MD') 
Baltimore_glm = 
  glm(whether_solved ~ victim_age + victim_sex + victim_race, family = binomial(link = logit), data = homicide_Baltimore_df) %>% 
  broom::tidy()
```
# Problem 3

Import dataset

```{r}
birthweight_df = read_csv("./data/birthweight.csv") %>% 
janitor::clean_names()
```

Convert numeric to factor

```{r}
birthweight_df = birthweight_df %>% 
 mutate(
    babysex = as.factor(babysex),
    frace = as.factor(frace),
    malform = as.factor(malform),
    mrace = as.factor(mrace)
  )
```

Check missing data

```{r}
sum(!complete.cases(birthweight_df))
```

Answer:

There is no missing data in this dataset



